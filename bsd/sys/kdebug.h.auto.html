<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>kdebug.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">kdebug.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/* 	Copyright (c) 1997 Apple Computer, Inc.  All rights reserved.
 *
 * kdebug.h -   kernel_debug definitions
 *
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">BSD_SYS_KDEBUG_H</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_SYS_KDEBUG_H</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/cdefs.h&gt;</span>
__BEGIN_DECLS

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE_API_UNSTABLE</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/clock_types.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdint.h&gt;</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;Availability.h&gt;</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span>	<span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdint.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/branch_predicates.h&gt;</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Kdebug is a facility for tracing events occurring on a system.
 *
 * All events are tagged with a debugid, consisting of the following:
 *
 * +----------------+----------------+----------------------------+----+
 * |   Class (8)    |  Subclass (8)  |          Code (14)         |Func|
 * |                |                |                            |(2) |
 * +----------------+----------------+----------------------------+----+
 * \______________________________________________________________/
 *                            Eventid
 * \___________________________________________________________________/
 *                                 Debugid
 *
 * The eventid is a hierarchical ID, indicating which components an event is
 * referring to.  The debugid includes an eventid and two function qualifier
 * bits, to determine the structural significance of an event (whether it
 * starts or ends a series of grouped events).
 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CLASS_MASK</span>   (0xff000000)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CLASS_OFFSET</span> (24)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CLASS_MAX</span>    (0xff)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_SUBCLASS_MASK</span>   (0x00ff0000)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_SUBCLASS_OFFSET</span> (16)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_SUBCLASS_MAX</span>    (0xff)

<span class="enscript-comment">/* class and subclass mask */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CSC_MASK</span>   (0xffff0000)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CSC_OFFSET</span> (KDBG_SUBCLASS_OFFSET)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CODE_MASK</span>   (0x0000fffc)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CODE_OFFSET</span> (2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CODE_MAX</span>    (0x3fff)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_EVENTID_MASK</span> (0xfffffffc)

<span class="enscript-comment">/* Generate an eventid corresponding to Class, SubClass, and Code. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_EVENTID</span>(Class, SubClass, Code)                \
        ((((Class)    &amp;   0xff) &lt;&lt; KDBG_CLASS_OFFSET)    | \
         (((SubClass) &amp;   0xff) &lt;&lt; KDBG_SUBCLASS_OFFSET) | \
         (((Code)     &amp; 0x3fff) &lt;&lt; KDBG_CODE_OFFSET))
<span class="enscript-comment">/* Deprecated macro using old naming convention. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_CODE</span>(Class, SubClass, Code) \
        KDBG_EVENTID(Class, SubClass, Code)

<span class="enscript-comment">/* Extract pieces of the debug code. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_EXTRACT_CLASS</span>(Debugid) \
        ((uint8_t)(((Debugid) &amp; KDBG_CLASS_MASK) &gt;&gt; KDBG_CLASS_OFFSET))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_EXTRACT_SUBCLASS</span>(Debugid) \
        ((uint8_t)(((Debugid) &amp; KDBG_SUBCLASS_MASK) &gt;&gt; KDBG_SUBCLASS_OFFSET))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_EXTRACT_CSC</span>(Debugid) \
        ((uint16_t)(((Debugid) &amp; KDBG_CSC_MASK) &gt;&gt; KDBG_CSC_OFFSET))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_EXTRACT_CODE</span>(Debugid) \
        ((uint16_t)(((Debugid) &amp; KDBG_CODE_MASK) &gt;&gt; KDBG_CODE_OFFSET))

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">enum</span>
{
	KD_CALLBACK_KDEBUG_ENABLED,   		<span class="enscript-comment">// Trace is now enabled. No arguments
</span>	KD_CALLBACK_KDEBUG_DISABLED,  		<span class="enscript-comment">// Trace is now disabled. No arguments
</span>	KD_CALLBACK_SYNC_FLUSH,      		<span class="enscript-comment">// Request the latest entries from the IOP, and block until complete. No arguments
</span>	KD_CALLBACK_TYPEFILTER_CHANGED,		<span class="enscript-comment">// Typefilter is enabled. A read-only pointer to the typefilter is provided, but is only valid while in the callback.
</span>} kd_callback_type;
<span class="enscript-type">typedef</span> <span class="enscript-function-name">void</span> (*kd_callback_fn) (<span class="enscript-type">void</span>* context, kd_callback_type reason, <span class="enscript-type">void</span>* arg);

<span class="enscript-type">struct</span> kd_callback {
	kd_callback_fn	func;
	<span class="enscript-type">void</span>*		context;
	<span class="enscript-type">char</span>		iop_name[8]; <span class="enscript-comment">// null-terminated string with name of core.
</span>};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> kd_callback kd_callback_t;

<span class="enscript-comment">/*
 * Registers an IOP for participation in tracing.
 *
 * The registered callback function will be called with the
 * supplied context as the first argument, followed by a
 * kd_callback_type and an associated void* argument.
 *
 * The return value is a nonzero coreid that shall be used in
 * kernel_debug_enter() to refer to your IOP. If the allocation
 * failed, then 0 will be returned.
 *
 *
 * Caveats:
 * Note that not all callback calls will indicate a change in
 * state (e.g. disabling trace twice would send two disable
 * notifications).
 *
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kernel_debug_register_callback</span>(kd_callback_t callback);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kernel_debug_enter</span>(
	uint32_t	coreid,
	uint32_t	debugid,
	uint64_t	timestamp,
	uintptr_t	arg1,
	uintptr_t	arg2,
	uintptr_t	arg3,
	uintptr_t	arg4,
	uintptr_t	threadid
	);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

<span class="enscript-comment">/* The Function qualifiers  */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FUNC_START</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FUNC_END</span>		2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FUNC_NONE</span>		0

<span class="enscript-comment">/* The Kernel Debug Classes  */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_NETWORK</span>		2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FSYSTEM</span>		3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BSD</span>			4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOKIT</span>		5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRIVERS</span>		6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_TRACE</span>           	7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DLIL</span>	        8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_WORKQUEUE</span>		9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_CORESTORAGE</span>		10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_CG</span>         		11
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MISC</span>		20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_SECURITY</span>		30
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DYLD</span>           	31
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_QT</span>              	32
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_APPS</span>            	33
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_LAUNCHD</span>         	34
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_PERF</span>                37
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IMPORTANCE</span>          38
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BANK</span>                40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_XPC</span>                 41
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_ATM</span>                 42
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_ARIADNE</span>             43
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DAEMON</span>              44
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_ENERGYTRACE</span>         45


#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MIG</span>			255

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * OS components can use the full precision of the &quot;code&quot; field
 * (Class, SubClass, Code) to inject events using kdebug_trace() by
 * using:
 *
 * kdebug_trace(KDBG_CODE(DBG_XPC, 15, 1) | DBG_FUNC_NONE, 1, 2, 3, 4);
 *
 * These trace points can be included in production code, since they
 * use reserved, non-overlapping ranges. The performance impact when
 * kernel tracing is not enabled is minimal. Classes can be reserved
 * by filing a Radar in xnu|all.
 *
 * 64-bit arguments may be truncated if the system is using a 32-bit
 * kernel.
 *
 * On error, -1 will be returned and errno will indicate the error.
 */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kdebug_trace</span>(uint32_t code, uint64_t arg1, uint64_t arg2, uint64_t arg3, uint64_t arg4) __OSX_AVAILABLE_STARTING(__MAC_10_10_2, __IPHONE_8_2);
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*!
 * @function kdebug_trace_string
 *
 * @discussion
 * This function emits strings to kdebug trace along with an ID and allows
 * for previously-traced strings to be overwritten and invalidated.
 *
 * To start tracing a string and generate an ID to use to refer to it:
 *
 *      string_id = kdebug_trace_string(debugid, 0, &quot;string&quot;);
 *
 * To replace a string previously traced:
 *
 *      string_id = kdebug_trace_string(debugid, string_id, &quot;new string&quot;);
 *
 * To invalidate a string ID:
 *
 *      string_id = kdebug_trace_string(debugid, string_id, NULL);
 *
 * To check for errors:
 *
 *      if ((int64_t)string_id == -1) { perror(&quot;string error&quot;) }
 *
 * @param debugid
 * The `debugid` to check if its enabled before tracing and include as
 * an argument in the event containing the string.
 *
 * Some classes or subclasses are reserved for specific uses and are not
 * allowed to be used with this function.  No function qualifiers are
 * allowed on `debugid`.
 *
 * @param str_id
 * When 0, a new ID will be generated and returned if tracing is
 * enabled.
 *
 * Otherwise `str_id` must contain an ID that was previously generated
 * with this function.  Clents should pass NULL in `str` if `str_id`
 * is no longer in use.  Otherwise, the string previously mapped to
 * `str_id` will be overwritten with the contents of `str`.
 *
 * @param str
 * A NUL-terminated 'C' string containing the characters that should be
 * traced alongside `str_id`.
 *
 * If necessary, the string will be truncated at an
 * implementation-defined length.  The string must not be the empty
 * string, but can be NULL if a valid `str_id` is provided.
 *
 * @return
 * 0 if tracing is disabled or `debugid` is being filtered out of trace.
 * It can also return (int64_t)-1 if an error occured. Otherwise,
 * it returns the ID to use to refer to the string in future
 * kdebug_trace(2) calls.
 *
 * The errors that can occur are:
 *
 * EINVAL
 *      There are function qualifiers on `debugid`, `str` is empty, or
 *      `str_id` was not generated by this function.
 * EPERM
 *      The `debugid`'s class or subclass is reserved for internal use.
 * EFAULT
 *      `str` is an invalid address or NULL when `str_id` is 0.
 */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-type">extern</span> uint64_t <span class="enscript-function-name">kdebug_trace_string</span>(uint32_t debugid, uint64_t str_id,
                                    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *str)
<span class="enscript-function-name">__OSX_AVAILABLE_STARTING</span>(__MAC_10_11, __IPHONE_9_0);
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-comment">/* Used in early boot to log strings spanning only a single tracepoint. */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kernel_debug_string_simple</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *message);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/* **** The Kernel Debug Sub Classes for Mach (DBG_MACH) **** */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_KTRAP_x86</span>	0x02	<span class="enscript-comment">/* Kernel Traps on x86 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_DFLT</span>	0x03	<span class="enscript-comment">/* Data Translation Fault */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_IFLT</span>	0x04	<span class="enscript-comment">/* Inst Translation Fault */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_INTR</span>	0x05	<span class="enscript-comment">/* Interrupts */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_ALNG</span>	0x06	<span class="enscript-comment">/* Alignment Exception */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_UTRAP_x86</span>	0x07	<span class="enscript-comment">/* User Traps on x86 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_FP</span>	0x08	<span class="enscript-comment">/* FP Unavail */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_DECI</span>	0x09	<span class="enscript-comment">/* Decrementer Interrupt */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_CHUD</span>		0x0A	<span class="enscript-comment">/* CHUD */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_SC</span>	0x0C	<span class="enscript-comment">/* System Calls */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_TRACE</span>	0x0D	<span class="enscript-comment">/* Trace exception */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_EXCP_EMUL</span>	0x0E	<span class="enscript-comment">/* Instruction emulated */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_IHDLR</span>		0x10	<span class="enscript-comment">/* Interrupt Handlers */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_IPC</span>		0x20	<span class="enscript-comment">/* Inter Process Comm */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_VM</span>		0x30	<span class="enscript-comment">/* Virtual Memory */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_LEAKS</span>		0x31    <span class="enscript-comment">/* alloc/free */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_SCHED</span>		0x40	<span class="enscript-comment">/* Scheduler */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_MACH_MSGID_INVALID</span>	0x50	<span class="enscript-comment">/* Messages - invalid */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_LOCKS</span>		0x60	<span class="enscript-comment">/* new lock APIs */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_PMAP</span>		0x70	<span class="enscript-comment">/* pmap */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_CLOCK</span>		0x80	<span class="enscript-comment">/* clock */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_MP</span>		0x90	<span class="enscript-comment">/* MP related */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_VM_PRESSURE</span>	0xA0	<span class="enscript-comment">/* Memory Pressure Events */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_STACKSHOT</span>		0xA1	<span class="enscript-comment">/* Stackshot/Microstackshot subsystem */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_SFI</span>			0xA2	<span class="enscript-comment">/* Selective Forced Idle (SFI) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_ENERGY_PERF</span>	0xA3 <span class="enscript-comment">/* Energy/performance resource stats */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MACH_SYSDIAGNOSE</span>	0xA4	<span class="enscript-comment">/* sysdiagnose keychord */</span>

<span class="enscript-comment">/* Codes for Scheduler (DBG_MACH_SCHED) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_SCHED</span>              0x0     <span class="enscript-comment">/* Scheduler */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_STACK_ATTACH</span>       0x1     <span class="enscript-comment">/* stack_attach() */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_STACK_HANDOFF</span>      0x2     <span class="enscript-comment">/* stack_handoff() */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_CALL_CONT</span>          0x3     <span class="enscript-comment">/* call_continuation() */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_CALLOUT</span>            0x4     <span class="enscript-comment">/* callouts */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_STACK_DETACH</span>       0x5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_MAKE_RUNNABLE</span>      0x6     <span class="enscript-comment">/* make thread runnable */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_PROMOTE</span>            0x7	<span class="enscript-comment">/* promoted due to resource */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_DEMOTE</span>             0x8	<span class="enscript-comment">/* promotion undone */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IDLE</span>               0x9	<span class="enscript-comment">/* processor idling */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_STACK_DEPTH</span>        0xa	<span class="enscript-comment">/* stack depth at switch */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_MOVED</span>              0xb	<span class="enscript-comment">/* did not use original scheduling decision */</span>
<span class="enscript-comment">/* unused                       0xc	*/</span>
<span class="enscript-comment">/* unused                       0xd	*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_FAILSAFE</span>           0xe	<span class="enscript-comment">/* tripped fixed-pri/RT failsafe */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_BLOCK</span>              0xf	<span class="enscript-comment">/* thread block */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_WAIT</span>		0x10	<span class="enscript-comment">/* thread wait assertion */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_GET_URGENCY</span>	0x14	<span class="enscript-comment">/* Urgency queried by platform */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_URGENCY</span>		0x15	<span class="enscript-comment">/* Urgency (RT/BG/NORMAL) communicated
   					 * to platform
					 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_REDISPATCH</span>		0x16	<span class="enscript-comment">/* &quot;next thread&quot; thread redispatched */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_REMOTE_AST</span>		0x17	<span class="enscript-comment">/* AST signal issued to remote processor */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_SCHED_CHOOSE_PROCESSOR</span>	0x18	<span class="enscript-comment">/* Result of choose_processor */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_DEEP_IDLE</span>          0x19	<span class="enscript-comment">/* deep idle on master processor */</span>
<span class="enscript-comment">/* unused                       0x1a    was MACH_SCHED_DECAY_PRIORITY */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_CPU_THROTTLE_DISABLE</span>	0x1b	<span class="enscript-comment">/* Global CPU Throttle Disable */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_RW_PROMOTE</span>            0x1c	<span class="enscript-comment">/* promoted due to RW lock promotion */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_RW_DEMOTE</span>             0x1d	<span class="enscript-comment">/* promotion due to RW lock undone */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_SCHED_MAINTENANCE</span>     0x1f <span class="enscript-comment">/* periodic maintenance thread */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_DISPATCH</span>              0x20 <span class="enscript-comment">/* context switch completed */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_QUANTUM_HANDOFF</span>       0x21 <span class="enscript-comment">/* quantum handoff occurred */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_MULTIQ_DEQUEUE</span>        0x22 <span class="enscript-comment">/* Result of multiq dequeue */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_SCHED_THREAD_SWITCH</span>   0x23 <span class="enscript-comment">/* attempt direct context switch to hinted thread */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_SCHED_SMT_BALANCE</span>     0x24 <span class="enscript-comment">/* SMT load balancing ASTs */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_REMOTE_DEFERRED_AST</span>   0x25 <span class="enscript-comment">/* Deferred AST started against remote processor */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_REMOTE_CANCEL_AST</span>     0x26 <span class="enscript-comment">/* Canceled deferred AST for remote processor */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_SCHED_CHANGE_PRIORITY</span> 0x27 <span class="enscript-comment">/* thread sched priority changed */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_SCHED_UPDATE_REC_CORES</span>	0x28	<span class="enscript-comment">/* Change to recommended processor bitmask */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_STACK_WAIT</span>            0x29 <span class="enscript-comment">/* Thread could not be switched-to because of kernel stack shortage */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_THREAD_BIND</span>           0x2a <span class="enscript-comment">/* Thread was bound (or unbound) to a processor */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_WAITQ_PROMOTE</span>         0x2b <span class="enscript-comment">/* Thread promoted by waitq boost */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_WAITQ_DEMOTE</span>          0x2c <span class="enscript-comment">/* Thread demoted from waitq boost */</span>

<span class="enscript-comment">/* Variants for MACH_MULTIQ_DEQUEUE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_MULTIQ_BOUND</span>     1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_MULTIQ_GROUP</span>     2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_MULTIQ_GLOBAL</span>    3

<span class="enscript-comment">/* Arguments for vm_fault (DBG_MACH_VM) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_ZERO_FILL_FAULT</span>   1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_PAGEIN_FAULT</span>      2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_COW_FAULT</span>         3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_CACHE_HIT_FAULT</span>   4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_NZF_PAGE_FAULT</span>    5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_GUARD_FAULT</span>	      6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_PAGEINV_FAULT</span>     7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_PAGEIND_FAULT</span>     8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_COMPRESSOR_FAULT</span>  9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_COMPRESSOR_SWAPIN_FAULT</span>  10

<span class="enscript-comment">/* Codes for IPC (DBG_MACH_IPC) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_TASK_SUSPEND</span>			0x0	<span class="enscript-comment">/* Suspended a task */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_TASK_RESUME</span> 		  	0x1	<span class="enscript-comment">/* Resumed a task */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_THREAD_SET_VOUCHER</span> 		0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_MSG_SEND</span>			0x3	<span class="enscript-comment">/* mach msg send, uniq msg info */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_MSG_RECV</span>			0x4	<span class="enscript-comment">/* mach_msg receive */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_MSG_RECV_VOUCHER_REFUSED</span>	0x5	<span class="enscript-comment">/* mach_msg receive, voucher refused */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_KMSG_FREE</span>			0x6	<span class="enscript-comment">/* kernel free of kmsg data */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_VOUCHER_CREATE</span>			0x7	<span class="enscript-comment">/* Voucher added to global voucher hashtable */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_VOUCHER_CREATE_ATTR_DATA</span>	0x8	<span class="enscript-comment">/* Attr data for newly created voucher */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MACH_IPC_VOUCHER_DESTROY</span>		0x9	<span class="enscript-comment">/* Voucher removed from global voucher hashtable */</span>

<span class="enscript-comment">/* Codes for pmap (DBG_MACH_PMAP) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__CREATE</span>		0x0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__DESTROY</span>		0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__PROTECT</span>		0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__PAGE_PROTECT</span>	0x3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__ENTER</span>		0x4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__REMOVE</span>		0x5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__NEST</span>		0x6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__UNNEST</span>		0x7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__FLUSH_TLBS</span>	0x8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__UPDATE_INTERRUPT</span>	0x9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__ATTRIBUTE_CLEAR</span>	0xa
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__REUSABLE</span>		0xb
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__QUERY_RESIDENT</span>	0xc
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__FLUSH_KERN_TLBS</span>	0xd
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__FLUSH_DELAYED_TLBS</span>	0xe
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__FLUSH_TLBS_TO</span>	0xf
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PMAP__FLUSH_EPT</span> 	0x10

<span class="enscript-comment">/* Codes for clock (DBG_MACH_CLOCK) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MACH_EPOCH_CHANGE</span>	0x0	<span class="enscript-comment">/* wake epoch change */</span>


<span class="enscript-comment">/* Codes for Stackshot/Microstackshot (DBG_MACH_STACKSHOT) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MICROSTACKSHOT_RECORD</span>	0x0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MICROSTACKSHOT_GATHER</span>	0x1

<span class="enscript-comment">/* Codes for sysdiagnose */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SYSDIAGNOSE_NOTIFY_USER</span>	0x0

<span class="enscript-comment">/* Codes for Selective Forced Idle (DBG_MACH_SFI) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_SET_WINDOW</span>			0x0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_CANCEL_WINDOW</span>		0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_SET_CLASS_OFFTIME</span>		0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_CANCEL_CLASS_OFFTIME</span>	0x3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_THREAD_DEFER</span>		0x4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_OFF_TIMER</span>			0x5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_ON_TIMER</span>			0x6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_WAIT_CANCELED</span>		0x7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_PID_SET_MANAGED</span>		0x8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_PID_CLEAR_MANAGED</span>		0x9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SFI_GLOBAL_DEFER</span>		0xa
<span class="enscript-comment">/* **** The Kernel Debug Sub Classes for Network (DBG_NETWORK) **** */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_NETIP</span>	1	<span class="enscript-comment">/* Internet Protocol */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_NETARP</span>	2	<span class="enscript-comment">/* Address Resolution Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETUDP</span>	3	<span class="enscript-comment">/* User Datagram Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETTCP</span>	4	<span class="enscript-comment">/* Transmission Control Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETICMP</span>	5	<span class="enscript-comment">/* Internet Control Message Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETIGMP</span>	6	<span class="enscript-comment">/* Internet Group Management Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETRIP</span>	7	<span class="enscript-comment">/* Routing Information Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETOSPF</span>	8	<span class="enscript-comment">/* Open Shortest Path First */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETISIS</span>	9	<span class="enscript-comment">/* Intermediate System to Intermediate System */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETSNMP</span>	10	<span class="enscript-comment">/* Simple Network Management Protocol */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_NETSOCK</span>	11	<span class="enscript-comment">/* Socket Layer */</span>

<span class="enscript-comment">/* For Apple talk */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETAARP</span>	100	<span class="enscript-comment">/* Apple ARP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETDDP</span>	101	<span class="enscript-comment">/* Datagram Delivery Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETNBP</span>	102	<span class="enscript-comment">/* Name Binding Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETZIP</span>	103	<span class="enscript-comment">/* Zone Information Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETADSP</span>	104	<span class="enscript-comment">/* Name Binding Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETATP</span>	105	<span class="enscript-comment">/* Apple Transaction Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETASP</span>	106	<span class="enscript-comment">/* Apple Session Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETAFP</span>	107	<span class="enscript-comment">/* Apple Filing Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETRTMP</span>	108	<span class="enscript-comment">/* Routing Table Maintenance Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETAURP</span>	109	<span class="enscript-comment">/* Apple Update Routing Protocol */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETIPSEC</span>	128	<span class="enscript-comment">/* IPsec Protocol  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_NETVMNET</span>	129	<span class="enscript-comment">/* VMNet */</span>

<span class="enscript-comment">/* **** The Kernel Debug Sub Classes for IOKIT (DBG_IOKIT) **** */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOINTC</span>			0	<span class="enscript-comment">/* Interrupt controller */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOWORKLOOP</span>			1	<span class="enscript-comment">/* Work from work loop */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOINTES</span>			2	<span class="enscript-comment">/* Interrupt event source */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOCLKES</span>			3	<span class="enscript-comment">/* Clock event source */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOCMDQ</span>			4	<span class="enscript-comment">/* Command queue latencies */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOMCURS</span>			5	<span class="enscript-comment">/* Memory Cursor */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOMDESC</span>			6	<span class="enscript-comment">/* Memory Descriptors */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOPOWER</span>			7	<span class="enscript-comment">/* Power Managerment */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOSERVICE</span>			8	<span class="enscript-comment">/* Matching etc. */</span>

<span class="enscript-comment">/* **** 9-32 reserved for internal IOKit usage **** */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOSTORAGE</span>		32	<span class="enscript-comment">/* Storage layers */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IONETWORK</span>		33	<span class="enscript-comment">/* Network layers */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IOKEYBOARD</span>		34	<span class="enscript-comment">/* Keyboard */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IOHID</span>		35	<span class="enscript-comment">/* HID Devices */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IOAUDIO</span>		36	<span class="enscript-comment">/* Audio */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IOSERIAL</span>		37	<span class="enscript-comment">/* Serial */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IOTTY</span>		38	<span class="enscript-comment">/* TTY layers */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOSAM</span>		39	<span class="enscript-comment">/* SCSI Architecture Model layers */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOPARALLELATA</span>   	40	<span class="enscript-comment">/* Parallel ATA */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOPARALLELSCSI</span>	41	<span class="enscript-comment">/* Parallel SCSI */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOSATA</span>		42	<span class="enscript-comment">/* Serial-ATA */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOSAS</span>		43	<span class="enscript-comment">/* SAS */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOFIBRECHANNEL</span>	44	<span class="enscript-comment">/* FiberChannel */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOUSB</span>		45	<span class="enscript-comment">/* USB */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOBLUETOOTH</span>		46	<span class="enscript-comment">/* Bluetooth */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOFIREWIRE</span>		47	<span class="enscript-comment">/* FireWire */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOINFINIBAND</span>	48	<span class="enscript-comment">/* Infiniband */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOCPUPM</span>		49	<span class="enscript-comment">/* CPU Power Management */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOGRAPHICS</span>		50	<span class="enscript-comment">/* Graphics */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HIBERNATE</span>		51	<span class="enscript-comment">/* hibernation related events */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOTHUNDERBOLT</span>	52	<span class="enscript-comment">/* Thunderbolt */</span>


<span class="enscript-comment">/* Backwards compatibility */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_IOPOINTING</span>		DBG_IOHID			<span class="enscript-comment">/* OBSOLETE: Use DBG_IOHID instead */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IODISK</span>			DBG_IOSTORAGE		<span class="enscript-comment">/* OBSOLETE: Use DBG_IOSTORAGE instead */</span>

<span class="enscript-comment">/* **** The Kernel Debug Sub Classes for Device Drivers (DBG_DRIVERS) **** */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVSTORAGE</span>		1	<span class="enscript-comment">/* Storage layers */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_DRVNETWORK</span>		2	<span class="enscript-comment">/* Network layers */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_DRVKEYBOARD</span>		3	<span class="enscript-comment">/* Keyboard */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_DRVHID</span>		4	<span class="enscript-comment">/* HID Devices */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_DRVAUDIO</span>		5	<span class="enscript-comment">/* Audio */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_DRVSERIAL</span>		7	<span class="enscript-comment">/* Serial */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVSAM</span>		8	<span class="enscript-comment">/* SCSI Architecture Model layers */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVPARALLELATA</span>  	9	<span class="enscript-comment">/* Parallel ATA */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVPARALLELSCSI</span>	10	<span class="enscript-comment">/* Parallel SCSI */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVSATA</span>		11	<span class="enscript-comment">/* Serial ATA */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVSAS</span>		12	<span class="enscript-comment">/* SAS */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVFIBRECHANNEL</span>	13	<span class="enscript-comment">/* FiberChannel */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVUSB</span>		14	<span class="enscript-comment">/* USB */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVBLUETOOTH</span>	15	<span class="enscript-comment">/* Bluetooth */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVFIREWIRE</span>		16	<span class="enscript-comment">/* FireWire */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVINFINIBAND</span>	17	<span class="enscript-comment">/* Infiniband */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVGRAPHICS</span>		18  	<span class="enscript-comment">/* Graphics */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVSD</span>		19 	<span class="enscript-comment">/* Secure Digital */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVNAND</span>		20	<span class="enscript-comment">/* NAND drivers and layers */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_SSD</span>			21	<span class="enscript-comment">/* SSD */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVSPI</span>		22	<span class="enscript-comment">/* SPI */</span>

<span class="enscript-comment">/* Backwards compatibility */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_DRVPOINTING</span>		DBG_DRVHID	<span class="enscript-comment">/* OBSOLETE: Use DBG_DRVHID instead */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DRVDISK</span>		DBG_DRVSTORAGE	<span class="enscript-comment">/* OBSOLETE: Use DBG_DRVSTORAGE instead */</span>

<span class="enscript-comment">/* **** The Kernel Debug Sub Classes for the DLIL Layer (DBG_DLIL) **** */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DLIL_STATIC</span> 1       <span class="enscript-comment">/* Static DLIL code */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DLIL_PR_MOD</span> 2       <span class="enscript-comment">/* DLIL Protocol Module */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DLIL_IF_MOD</span> 3       <span class="enscript-comment">/* DLIL Interface Module */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DLIL_PR_FLT</span> 4       <span class="enscript-comment">/* DLIL Protocol Filter */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DLIL_IF_FLT</span> 5       <span class="enscript-comment">/* DLIL Interface FIlter */</span>

<span class="enscript-comment">/* The Kernel Debug Sub Classes for File System (DBG_FSYSTEM) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FSRW</span>      1       <span class="enscript-comment">/* reads and writes to the filesystem */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DKRW</span>      2       <span class="enscript-comment">/* reads and writes to the disk */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FSVN</span>      3       <span class="enscript-comment">/* vnode operations (inc. locking/unlocking) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_FSLOOOKUP</span> 4       <span class="enscript-comment">/* namei and other lookup-related operations */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_JOURNAL</span>   5       <span class="enscript-comment">/* journaling operations */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_IOCTL</span>     6       <span class="enscript-comment">/* ioctl to the disk */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BOOTCACHE</span> 7       <span class="enscript-comment">/* bootcache operations */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS</span>       8       <span class="enscript-comment">/* HFS-specific events; see bsd/hfs/hfs_kdebug.h */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_EXFAT</span>     0xE     <span class="enscript-comment">/* ExFAT-specific events; see the exfat project */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_MSDOS</span>     0xF     <span class="enscript-comment">/* FAT-specific events; see the msdosfs project */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_ACFS</span>      0x10    <span class="enscript-comment">/* Xsan-specific events; see the XsanFS project */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_THROTTLE</span>  0x11    <span class="enscript-comment">/* I/O Throttling events */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_CONTENT_PROT</span> 0xCF <span class="enscript-comment">/* Content Protection Events: see bsd/sys/cprotect.h */</span>

<span class="enscript-comment">/*
 * For Kernel Debug Sub Class DBG_HFS, state bits for hfs_update event
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_ACCTIME</span>   0x01
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_MODTIME</span>	 0x02
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_CHGTIME</span>	 0x04
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_MODIFIED</span>	 0x08
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_FORCE</span>     0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_DATEADDED</span> 0x20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_MINOR</span>     0x40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_HFS_UPDATE_SKIPPED</span>	 0x80

<span class="enscript-comment">/* The Kernel Debug Sub Classes for BSD */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BSD_PROC</span>		0x01	<span class="enscript-comment">/* process/signals related */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BSD_MEMSTAT</span>		0x02	<span class="enscript-comment">/* memorystatus / jetsam operations */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_BSD_EXCP_SC</span>		0x0C	<span class="enscript-comment">/* System Calls */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_BSD_AIO</span>		0x0D	<span class="enscript-comment">/* aio (POSIX async IO) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BSD_SC_EXTENDED_INFO</span> 0x0E	<span class="enscript-comment">/* System Calls, extended info */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_BSD_SC_EXTENDED_INFO2</span> 0x0F	<span class="enscript-comment">/* System Calls, extended info */</span>


<span class="enscript-comment">/* The Codes for BSD subcode class DBG_BSD_PROC */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_PROC_EXIT</span>		1	<span class="enscript-comment">/* process exit */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_PROC_FRCEXIT</span> 	2	<span class="enscript-comment">/* Kernel force termination */</span>

<span class="enscript-comment">/* Codes for BSD subcode class DBG_BSD_MEMSTAT */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_SCAN</span>             1  <span class="enscript-comment">/* memorystatus thread awake */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_JETSAM</span>           2  <span class="enscript-comment">/* LRU jetsam */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_JETSAM_HIWAT</span>     3  <span class="enscript-comment">/* highwater jetsam */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_FREEZE</span>           4  <span class="enscript-comment">/* freeze process */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_LATENCY_COALESCE</span> 5  <span class="enscript-comment">/* delay imposed to coalesce jetsam reports */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_UPDATE</span>           6  <span class="enscript-comment">/* priority update */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_IDLE_DEMOTE</span>      7  <span class="enscript-comment">/* idle demotion fired */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_CLEAR_ERRORS</span>     8  <span class="enscript-comment">/* reset termination error state */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_DIRTY_TRACK</span>      9  <span class="enscript-comment">/* track the process state */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_DIRTY_SET</span>       10  <span class="enscript-comment">/* set the process state */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_DIRTY_CLEAR</span>     11  <span class="enscript-comment">/* clear the process state */</span>
#<span class="enscript-reference">ifdef</span>  <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_GRP_SET_PROP</span>    12  <span class="enscript-comment">/* set group properties */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BSD_MEMSTAT_DO_KILL</span>         13  <span class="enscript-comment">/* memorystatus kills */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

<span class="enscript-comment">/* The Kernel Debug Sub Classes for DBG_TRACE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_TRACE_DATA</span>      0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_TRACE_STRING</span>    1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_TRACE_INFO</span>	    2

<span class="enscript-comment">/* The Kernel Debug events: */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_DATA_NEWTHREAD</span>		(TRACEDBG_CODE(DBG_TRACE_DATA, 1))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_DATA_EXEC</span>			(TRACEDBG_CODE(DBG_TRACE_DATA, 2))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_DATA_THREAD_TERMINATE</span>	(TRACEDBG_CODE(DBG_TRACE_DATA, 3))
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TRACE_STRING_GLOBAL</span>		(TRACEDBG_CODE(DBG_TRACE_STRING, 0))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_STRING_NEWTHREAD</span>		(TRACEDBG_CODE(DBG_TRACE_STRING, 1))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_STRING_EXEC</span>		(TRACEDBG_CODE(DBG_TRACE_STRING, 2))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_PANIC</span>			(TRACEDBG_CODE(DBG_TRACE_INFO, 0))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_TIMESTAMPS</span>		(TRACEDBG_CODE(DBG_TRACE_INFO, 1))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_LOST_EVENTS</span>		(TRACEDBG_CODE(DBG_TRACE_INFO, 2))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_WRITING_EVENTS</span>		(TRACEDBG_CODE(DBG_TRACE_INFO, 3))
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TRACE_INFO_STRING</span>		(TRACEDBG_CODE(DBG_TRACE_INFO, 4))

<span class="enscript-comment">/* The Kernel Debug Sub Classes for DBG_CORESTORAGE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_CS_IO</span>	0

<span class="enscript-comment">/* The Kernel Debug Sub Classes for DBG_SECURITY */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_SEC_KERNEL</span>	0	<span class="enscript-comment">/* raw entropy collected by the kernel */</span>

<span class="enscript-comment">/* Sub-class codes for CoreGraphics (DBG_CG) are defined in its component. */</span>

<span class="enscript-comment">/* The Kernel Debug Sub Classes for DBG_MISC */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_EVENT</span>	0x10
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DBG_BUFFER</span>	0x20

<span class="enscript-comment">/* The Kernel Debug Sub Classes for DBG_DYLD */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DYLD_STRING</span>   5

<span class="enscript-comment">/* The Kernel Debug modifiers for the DBG_DKRW sub class */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_DONE</span> 	0x01
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_READ</span>	0x02
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_ASYNC</span>	0x04
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_META</span>	0x08
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_PAGING</span>	0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_THROTTLE</span>	0x20 <span class="enscript-comment">/* Deprecated, still provided so fs_usage doesn't break */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_PASSIVE</span>	0x40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_NOCACHE</span>	0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_TIER_MASK</span>	0xF00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DKIO_TIER_SHIFT</span>	8

<span class="enscript-comment">/* Kernel Debug Sub Classes for Applications (DBG_APPS) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_APP_LOGINWINDOW</span>     0x03
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_APP_AUDIO</span>           0x04
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_APP_SIGPOST</span>         0x0A
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_APP_APPKIT</span>          0x0C
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_APP_SAMBA</span>           0x80

<span class="enscript-comment">/* Kernel Debug codes for Throttling (DBG_THROTTLE) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">OPEN_THROTTLE_WINDOW</span>	0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROCESS_THROTTLED</span>	0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IO_THROTTLE_DISABLE</span>	0x3


<span class="enscript-comment">/* Subclasses for MACH Importance Policies (DBG_IMPORTANCE) */</span>
<span class="enscript-comment">/* TODO: Split up boost and task policy? */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_ASSERTION</span>           0x10    <span class="enscript-comment">/* Task takes/drops a boost assertion */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_BOOST</span>               0x11    <span class="enscript-comment">/* Task boost level changed */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_MSG</span>                 0x12    <span class="enscript-comment">/* boosting message sent by donating task on donating port */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_WATCHPORT</span>           0x13    <span class="enscript-comment">/* port marked as watchport, and boost was transferred to the watched task */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_TASK_SUPPRESSION</span>    0x17    <span class="enscript-comment">/* Task changed suppression behaviors */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_TASK_APPTYPE</span>        0x18    <span class="enscript-comment">/* Task launched with apptype */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_UPDATE</span>              0x19    <span class="enscript-comment">/* Requested -&gt; effective calculation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_USYNCH_QOS_OVERRIDE</span> 0x1A    <span class="enscript-comment">/* Userspace synchronization applied QoS override to resource owning thread */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_DONOR_CHANGE</span>        0x1B    <span class="enscript-comment">/* The iit_donor bit changed */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_MAIN_THREAD_QOS</span>     0x1C    <span class="enscript-comment">/* The task's main thread QoS was set */</span>
<span class="enscript-comment">/* DBG_IMPORTANCE subclasses  0x20 - 0x3F reserved for task policy flavors */</span>

<span class="enscript-comment">/* Codes for IMP_ASSERTION */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_HOLD</span>                0x2     <span class="enscript-comment">/* Task holds a boost assertion */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_DROP</span>                0x4     <span class="enscript-comment">/* Task drops a boost assertion */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_EXTERN</span>              0x8     <span class="enscript-comment">/* boost assertion moved from kernel to userspace responsibility (externalized) */</span>

<span class="enscript-comment">/* Codes for IMP_BOOST */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_BOOSTED</span>             0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_UNBOOSTED</span>           0x2     <span class="enscript-comment">/* Task drops a boost assertion */</span>

<span class="enscript-comment">/* Codes for IMP_MSG */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_MSG_SEND</span>            0x1     <span class="enscript-comment">/* boosting message sent by donating task on donating port */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_MSG_DELV</span>            0x2     <span class="enscript-comment">/* boosting message delivered to task */</span>

<span class="enscript-comment">/* Codes for IMP_UPDATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_UPDATE_TASK_CREATE</span>  0x1

<span class="enscript-comment">/* Codes for IMP_USYNCH_QOS_OVERRIDE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_USYNCH_ADD_OVERRIDE</span>		0x0		<span class="enscript-comment">/* add override for a contended resource */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_USYNCH_REMOVE_OVERRIDE</span>	0x1		<span class="enscript-comment">/* remove override for a contended resource */</span>

<span class="enscript-comment">/* Codes for IMP_DONOR_CHANGE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_DONOR_UPDATE_LIVE_DONOR_STATE</span>	0x0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IMP_DONOR_INIT_DONOR_STATE</span>		0x1

<span class="enscript-comment">/* Subclasses for MACH Bank Voucher Attribute Manager (DBG_BANK) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BANK_ACCOUNT_INFO</span>		0x10	<span class="enscript-comment">/* Trace points related to bank account struct */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BANK_TASK_INFO</span>			0x11	<span class="enscript-comment">/* Trace points related to bank task struct */</span>

<span class="enscript-comment">/* Subclasses for MACH ATM Voucher Attribute Manager (ATM) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_SUBAID_INFO</span>			0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_GETVALUE_INFO</span>		0x20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_UNREGISTER_INFO</span>		0x30

<span class="enscript-comment">/* Codes for BANK_ACCOUNT_INFO */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BANK_SETTLE_CPU_TIME</span>		0x1	<span class="enscript-comment">/* Bank ledger(chit) rolled up to tasks. */</span>

<span class="enscript-comment">/* Codes for ATM_SUBAID_INFO */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_MIN_CALLED</span>				0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_LINK_LIST_TRIM</span>			0x2

<span class="enscript-comment">/* Codes for ATM_GETVALUE_INFO */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_VALUE_REPLACED</span>			0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_VALUE_ADDED</span> 			0x2

<span class="enscript-comment">/* Codes for ATM_UNREGISTER_INFO */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_VALUE_UNREGISTERED</span>			0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ATM_VALUE_DIFF_MAILBOX</span>			0x2

<span class="enscript-comment">/* Kernel Debug Sub Classes for daemons (DBG_DAEMON) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DBG_DAEMON_COREDUET</span>			0x1

<span class="enscript-comment">/**********************************************************************/</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_MIGCODE</span>(msgid) ((DBG_MIG &lt;&lt; KDBG_CLASS_OFFSET) | \
                             (((msgid) &amp; 0x3fffff) &lt;&lt; KDBG_CODE_OFFSET))

#<span class="enscript-reference">define</span> <span class="enscript-function-name">MACHDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_MACH, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">NETDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_NETWORK, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">FSDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_FSYSTEM, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BSDDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_BSD, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IOKDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_IOKIT, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">DRVDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_DRIVERS, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">TRACEDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_TRACE, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">MISCDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_MISC, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">DLILDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_DLIL, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">SECURITYDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_SECURITY, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">DYLDDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_DYLD, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">QTDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_QT, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">APPSDBG_CODE</span>(SubClass,code) KDBG_CODE(DBG_APPS, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">ARIADNEDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_ARIADNE, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">DAEMONDBG_CODE</span>(SubClass, code) KDBG_CODE(DBG_DAEMON, SubClass, code)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CPUPM_CODE</span>(code) IOKDBG_CODE(DBG_IOCPUPM, code)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KMEM_ALLOC_CODE</span> MACHDBG_CODE(DBG_MACH_LEAKS, 0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KMEM_ALLOC_CODE_2</span> MACHDBG_CODE(DBG_MACH_LEAKS, 1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KMEM_FREE_CODE</span> MACHDBG_CODE(DBG_MACH_LEAKS, 2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KMEM_FREE_CODE_2</span> MACHDBG_CODE(DBG_MACH_LEAKS, 3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ZALLOC_CODE</span> MACHDBG_CODE(DBG_MACH_LEAKS, 4)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ZALLOC_CODE_2</span> MACHDBG_CODE(DBG_MACH_LEAKS, 5)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ZFREE_CODE</span> MACHDBG_CODE(DBG_MACH_LEAKS, 6)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ZFREE_CODE_2</span> MACHDBG_CODE(DBG_MACH_LEAKS, 7)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PMAP_CODE</span>(code) MACHDBG_CODE(DBG_MACH_PMAP, code)


#<span class="enscript-reference">define</span> <span class="enscript-function-name">IMPORTANCE_CODE</span>(SubClass, code) KDBG_CODE(DBG_IMPORTANCE, (SubClass), (code))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BANK_CODE</span>(SubClass, code) KDBG_CODE(DBG_BANK, (SubClass), (code))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">ATM_CODE</span>(SubClass, code) KDBG_CODE(DBG_ATM, (SubClass), (code))

<span class="enscript-comment">/* Kernel Debug Macros for specific daemons */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">COREDUETDBG_CODE</span>(code) DAEMONDBG_CODE(DBG_DAEMON_COREDUET, code)

<span class="enscript-comment">/*   Usage:
* kernel_debug((KDBG_CODE(DBG_NETWORK, DNET_PROTOCOL, 51) | DBG_FUNC_START),
*	offset, 0, 0, 0,0)
*
* For ex,
*
* #include &lt;sys/kdebug.h&gt;
*
* #define DBG_NETIPINIT NETDBG_CODE(DBG_NETIP,1)
*
*
* void
* ip_init()
* {
*	register struct protosw *pr;
*	register int i;
*
*	KERNEL_DEBUG(DBG_NETIPINIT | DBG_FUNC_START, 0,0,0,0,0)
* 	--------
*	KERNEL_DEBUG(DBG_NETIPINIT, 0,0,0,0,0)
* 	--------
*	KERNEL_DEBUG(DBG_NETIPINIT | DBG_FUNC_END, 0,0,0,0,0)
* }
*

*/</span>

<span class="enscript-type">extern</span> <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> kdebug_enable;
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_ENABLE_TRACE</span>   0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_ENABLE_ENTROPY</span> 0x2		<span class="enscript-comment">/* Obsolescent */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_ENABLE_CHUD</span>    0x4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_ENABLE_PPT</span>     0x8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_ENABLE_SERIAL</span> 0x10

<span class="enscript-comment">/*
 * Infer the supported kernel debug event level from config option.
 * Use (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_STANDARD) as a guard to protect
 * unaudited debug code.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL_NONE</span>     0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL_IST</span>      1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL_STANDARD</span> 2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL_FULL</span>     3

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">NO_KDEBUG</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL</span> KDEBUG_LEVEL_NONE
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">IST_KDEBUG</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL</span> KDEBUG_LEVEL_IST
	<span class="enscript-comment">// currently configured for the iOS release kernel
</span>#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">KDEBUG</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL</span> KDEBUG_LEVEL_FULL
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_LEVEL</span> KDEBUG_LEVEL_STANDARD
<span class="enscript-comment">/* Currently, all other kernel configurations (development, etc)
   build with KDEBUG_LEVEL_STANDARD.  As a result, KERNEL_DEBUG_CONSTANT*()
   are on by default but KERNEL_DEBUG*() are not.
*/</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> (<span class="enscript-variable-name">KDEBUG_LEVEL</span> &gt;= <span class="enscript-variable-name">KDEBUG_LEVEL_STANDARD</span>)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT</span>(x,a,b,c,d,e)				\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (__improbable(kdebug_enable &amp; ~KDEBUG_ENABLE_PPT))					\
        kernel_debug(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
		       (uintptr_t)d,(uintptr_t)e);			\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT1</span>(x,a,b,c,d,e)				\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (__improbable(kdebug_enable &amp; ~KDEBUG_ENABLE_PPT))					\
        kernel_debug1(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
			(uintptr_t)d,(uintptr_t)e);			\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_EARLY</span>(x,a,b,c,d)					\
<span class="enscript-keyword">do</span> {									\
        kernel_debug_early((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,	\
		           (uintptr_t)c, (uintptr_t)d);			\
} <span class="enscript-keyword">while</span>(0)
#<span class="enscript-reference">else</span>	<span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT</span>(x,a,b,c,d,e)				\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (kdebug_enable &amp; ~KDEBUG_ENABLE_PPT)						\
        kernel_debug(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
		       (uintptr_t)d,(uintptr_t)e);			\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT1</span>(x,a,b,c,d,e)				\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (kdebug_enable &amp; ~KDEBUG_ENABLE_PPT)						\
        kernel_debug1(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
			(uintptr_t)d,(uintptr_t)e);			\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_EARLY</span>(x,a,b,c,d)					\
<span class="enscript-keyword">do</span> {									\
        kernel_debug_early((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,	\
		           (uintptr_t)c, (uintptr_t)d);			\
} <span class="enscript-keyword">while</span>(0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_STANDARD) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT</span>(x,a,b,c,d,e) do { } while(0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT1</span>(x,a,b,c,d,e) do { } while(0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_EARLY</span>(x,a,b,c,d) do { } while(0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_STANDARD) */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>

<span class="enscript-comment">// Abbreviated version of above
</span>#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG</span>(x, ...) KDBG_(x, ## __VA_ARGS__, 5, 4, 3, 2, 1, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_</span>(x, a, b, c, d, e, n, ...) KDBG##n(x, a, b, c, d, e)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG0</span>(x, a, b, c, d, e) KERNEL_DEBUG_CONSTANT(x, 0, 0, 0, 0, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG1</span>(x, a, b, c, d, e) KERNEL_DEBUG_CONSTANT(x, a, 0, 0, 0, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG2</span>(x, a, b, c, d, e) KERNEL_DEBUG_CONSTANT(x, a, b, 0, 0, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG3</span>(x, a, b, c, d, e) KERNEL_DEBUG_CONSTANT(x, a, b, c, 0, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG4</span>(x, a, b, c, d, e) KERNEL_DEBUG_CONSTANT(x, a, b, c, d, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG5</span>(x, a, b, c, d, e) KERNEL_DEBUG_CONSTANT(x, a, b, c, d, e)

#<span class="enscript-reference">endif</span> // <span class="enscript-variable-name">KERNEL_PRIVATE</span>

<span class="enscript-comment">/*
 * Specify KDEBUG_PPT to indicate that the event belongs to the
 * limited PPT set.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_COMMON</span> (KDEBUG_ENABLE_TRACE|KDEBUG_ENABLE_CHUD|KDEBUG_ENABLE_PPT)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_TRACE</span>  (KDEBUG_ENABLE_TRACE|KDEBUG_ENABLE_CHUD)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_PPT</span>    (KDEBUG_ENABLE_PPT)

<span class="enscript-comment">/*
   KERNEL_DEBUG_CONSTANT_IST events provide an audited subset of
   tracepoints for userland system tracing tools.  This tracing level was
   created by 8857227 to protect fairplayd and other PT_DENY_ATTACH
   processes.  It has two effects: only KERNEL_DEBUG_CONSTANT_IST() traces
   are emitted and any PT_DENY_ATTACH processes will only emit basic
   traces as defined by the kernel_debug_filter() routine.
 */</span>
#<span class="enscript-reference">if</span> (<span class="enscript-variable-name">KDEBUG_LEVEL</span> &gt;= <span class="enscript-variable-name">KDEBUG_LEVEL_IST</span>)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT_IST</span>(type,x,a,b,c,d,e)			\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (__improbable(kdebug_enable &amp; type))				\
        kernel_debug(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
			(uintptr_t)d,(uintptr_t)e);			\
} <span class="enscript-keyword">while</span>(0)
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT_IST</span>(type,x,a,b,c,d,e)			\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (kdebug_enable &amp; type)					\
        kernel_debug(x,(uintptr_t)a,(uintptr_t)b,(uintptr_t)c,		\
			(uintptr_t)d,(uintptr_t)e);			\
} <span class="enscript-keyword">while</span>(0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>

<span class="enscript-comment">// whether to bother calculating EnergyTracing inputs
</span><span class="enscript-comment">// could chnage in future to see if DBG_ENERGYTRACE is active
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ENTR_SHOULDTRACE</span> kdebug_enable
<span class="enscript-comment">// encode logical EnergyTracing into 32/64 KDebug trace
</span>#<span class="enscript-reference">define</span> <span class="enscript-function-name">ENTR_KDTRACE</span>(component, opcode, lifespan, id, quality, value) 	\
<span class="enscript-keyword">do</span> {									\
    uint32_t kdcode__;							\
    uintptr_t highval__, lowval__, mask__ = 0xffffffff;			\
    kdcode__ = KDBG_CODE(DBG_ENERGYTRACE,component,opcode)|(lifespan); 	\
    highval__ = ((value) &gt;&gt; 32) &amp; mask__;				\
    lowval__ = (value) &amp; mask__;					\
    ENTR_KDTRACEFUNC(kdcode__, id, quality, highval__, lowval__);	\
} <span class="enscript-keyword">while</span>(0)

<span class="enscript-comment">/*
    Trace the association of two existing activations.

    An association is traced as a modification to the parent activation.
    In order to fit the sub-activation's component, activation code, and
    activation ID into a kdebug tracepoint, the arguments that would hold
    the value are left separate, and one stores the component and opcode
    of the sub-activation, while the other stores the pointer-sized
    activation ID.

	    arg2                   arg3               arg4
    +-----------------+  +~+----+----+--------+   +----------+
    |kEnTrModAssociate|  | |    |    |        |   |          |
    +-----------------+  +~+----+----+--------+   +----------+
			    8-bits unused       sub-activation ID
				 8-bit sub-component
				      16-bit sub-opcode

*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrModAssociate</span> (1 &lt;&lt; 28)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ENTR_KDASSOCIATE</span>(par_comp, par_opcode, par_act_id,		\
                         sub_comp, sub_opcode, sub_act_id)              \
<span class="enscript-keyword">do</span> {									\
    <span class="enscript-type">unsigned</span> sub_compcode = ((<span class="enscript-type">unsigned</span>)sub_comp &lt;&lt; 16) | sub_opcode;	\
    ENTR_KDTRACEFUNC(KDBG_CODE(DBG_ENERGYTRACE,par_comp,par_opcode),	\
		     par_act_id, kEnTrModAssociate, sub_compcode,	\
		     sub_act_id);					\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">else</span> <span class="enscript-comment">/* (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_IST) */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG_CONSTANT_IST</span>(type,x,a,b,c,d,e) do { } while(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ENTR_SHOULDTRACE</span> FALSE
#<span class="enscript-reference">define</span> <span class="enscript-function-name">ENTR_KDTRACE</span>(component, opcode, lifespan, id, quality, value) 	\
				    <span class="enscript-keyword">do</span> {} <span class="enscript-keyword">while</span> (0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ENTR_KDASSOCIATE</span>(par_comp, par_opcode, par_act_id,		\
		   	 sub_comp, sub_opcode, sub_act_id)		\
				    <span class="enscript-keyword">do</span> {} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_IST) */</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">NO_KDEBUG</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__kdebug_constant_only</span> __unused
#<span class="enscript-reference">endif</span>

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kernel_debug</span>(
		uint32_t  debugid,
		uintptr_t arg1,
		uintptr_t arg2,
		uintptr_t arg3,
		uintptr_t arg4,
		uintptr_t arg5);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kernel_debug1</span>(
		uint32_t  debugid,
		uintptr_t arg1,
		uintptr_t arg2,
		uintptr_t arg3,
		uintptr_t arg4,
		uintptr_t arg5);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kernel_debug_early</span>(
		uint32_t  debugid,
		uintptr_t arg1,
		uintptr_t arg2,
		uintptr_t arg3,
		uintptr_t arg4);

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * kernel_debug_string provides the same functionality as the
 * kdebug_trace_string syscall as a KPI.  str_id is an in/out
 * parameter that, if it's pointing to a string ID of 0, will
 * receive a generated ID.  If it provides a value in str_id,
 * then that will be used, instead.
 *
 * Returns an errno indicating the type of failure.
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>
<span class="enscript-function-name">kernel_debug_string</span>(uint32_t debugid, uint64_t *str_id, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *str);
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> (<span class="enscript-variable-name">KDEBUG_LEVEL</span> &gt;= <span class="enscript-variable-name">KDEBUG_LEVEL_FULL</span>)
#<span class="enscript-reference">ifdef</span>	<span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG</span>(x,a,b,c,d,e)					\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (__improbable(kdebug_enable &amp; ~KDEBUG_ENABLE_PPT))			\
        kernel_debug((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,		\
		     (uintptr_t)c, (uintptr_t)d, (uintptr_t)e);		\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG1</span>(x,a,b,c,d,e)					\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (__improbable(kdebug_enable &amp; ~KDEBUG_ENABLE_PPT))			\
        kernel_debug1((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,		\
		      (uintptr_t)c, (uintptr_t)d, (uintptr_t)e);	\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__kdebug_only</span>
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* !XNU_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG</span>(x,a,b,c,d,e)					\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (kdebug_enable &amp; ~KDEBUG_ENABLE_PPT)				\
        kernel_debug((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,		\
		     (uintptr_t)c, (uintptr_t)d, (uintptr_t)e);		\
} <span class="enscript-keyword">while</span>(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG1</span>(x,a,b,c,d,e)					\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-keyword">if</span> (kdebug_enable &amp; ~KDEBUG_ENABLE_PPT)				\
        kernel_debug1((uint32_t)x,  (uintptr_t)a, (uintptr_t)b,		\
		      (uintptr_t)c, (uintptr_t)d, (uintptr_t)e);	\
} <span class="enscript-keyword">while</span>(0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">else</span> <span class="enscript-comment">/* (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_FULL) */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG</span>(x,a,b,c,d,e) do {} while (0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DEBUG1</span>(x,a,b,c,d,e) do {} while (0)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__kdebug_only</span> __unused
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (KDEBUG_LEVEL &gt;= KDEBUG_LEVEL_FULL) */</span>


<span class="enscript-comment">// for EnergyTracing user space &amp; clients
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrCompKernel</span>	    2

<span class="enscript-comment">/*
    EnergyTracing opcodes

    Activations use DBG_FUNC_START/END.
    Events are DBG_FUNC_NONE.
 */</span>

<span class="enscript-comment">/* Socket reads and writes are uniquely identified by the (sanitized)
   pointer to the socket struct in question.  To associate this address
   with the user space file descriptor, we have a socket activation with
   the FD as its identifier and the socket struct pointer as its value.
*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrActKernSocket</span>	1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrActKernSockRead</span>	2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrActKernSockWrite</span>	3

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrActKernPoll</span>	10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrActKernSelect</span>	11
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrActKernKQWait</span>	12

<span class="enscript-comment">// events
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrEvUnblocked</span>	256

<span class="enscript-comment">// EnergyTracing flags (the low-order 16 bits of 'quality')
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrFlagNonBlocking</span>	1 &lt;&lt; 0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">kEnTrFlagNoWork</span>		1 &lt;&lt; 1

<span class="enscript-comment">// and now the internal mechanism
</span>#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>

<span class="enscript-comment">// 20452597 requests that the trace macros not take an argument it throws away
</span>#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_DBG_IST_SANE</span>(x, a, b, c, d) 				\
        KERNEL_DEBUG_CONSTANT_IST(KDEBUG_TRACE, x, a, b, c, d,          \
                                  0 <span class="enscript-comment">/*__unused in kernel_debug()*/</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ENTR_KDTRACEFUNC</span> KERNEL_DBG_IST_SANE

<span class="enscript-comment">// value is int64_t, quality is uint32_t
</span>#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_ENERGYTRACE</span>(opcode, lifespan, id, quality, value)        \
            ENTR_KDTRACE(kEnTrCompKernel, opcode, lifespan, id,         \
                         quality, value)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KERNEL_ENTR_ASSOCIATE</span>(par_opcode, par_act_id, sub_opcode, sub_act_id) \
	    ENTR_KDASSOCIATE(kEnTrCompKernel, par_opcode, par_act_id,	\
			     kEnTrCompKernel, sub_opcode, sub_act_id)

<span class="enscript-comment">// end EnergyTracing
</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/boolean.h&gt;</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NUMPARMS</span> 23

<span class="enscript-type">struct</span> proc;

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kdebug_lookup_gen_events</span>(<span class="enscript-type">long</span> *dbg_parms, <span class="enscript-type">int</span> dbg_namelen, <span class="enscript-type">void</span> *dp, boolean_t lookup);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kdbg_trace_data</span>(<span class="enscript-type">struct</span> proc *proc, <span class="enscript-type">long</span> *arg_pid);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kdbg_trace_string</span>(<span class="enscript-type">struct</span> proc *proc, <span class="enscript-type">long</span> *arg1, <span class="enscript-type">long</span> *arg2, <span class="enscript-type">long</span> *arg3, <span class="enscript-type">long</span> *arg4);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kdbg_dump_trace_to_file</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *);
<span class="enscript-type">void</span> <span class="enscript-function-name">start_kern_tracing</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>, boolean_t);
<span class="enscript-type">void</span> <span class="enscript-function-name">start_kern_tracing_with_typefilter</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>, boolean_t, <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>);
<span class="enscript-type">struct</span> task;
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kdbg_get_task_name</span>(<span class="enscript-type">char</span>*, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> task *task);
<span class="enscript-type">void</span> <span class="enscript-function-name">disable_wrap</span>(uint32_t *old_slowcheck, uint32_t *old_flags);
<span class="enscript-type">void</span> <span class="enscript-function-name">enable_wrap</span>(uint32_t old_slowcheck, boolean_t lostevents);
<span class="enscript-type">void</span> <span class="enscript-function-name">release_storage_unit</span>(<span class="enscript-type">int</span> cpu,  uint32_t storage_unit);
<span class="enscript-type">int</span> <span class="enscript-function-name">allocate_storage_unit</span>(<span class="enscript-type">int</span> cpu);

#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_CLASS_ENCODE</span>(Class, SubClass) KDBG_EVENTID(Class, SubClass, 0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">KDBG_CLASS_DECODE</span>(Debugid)         (Debugid &amp; KDBG_CSC_MASK)


#<span class="enscript-reference">endif</span>  <span class="enscript-comment">/* KERNEL_PRIVATE */</span>


#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_API_UNSTABLE */</span>
__END_DECLS


#<span class="enscript-reference">ifdef</span>	<span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE_API_PRIVATE</span>
<span class="enscript-comment">/*
 * private kernel_debug definitions
 */</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	uint64_t	timestamp;
	uintptr_t	arg1;
	uintptr_t	arg2;
	uintptr_t	arg3;
	uintptr_t	arg4;
	uintptr_t	arg5;       <span class="enscript-comment">/* will hold current thread */</span>
	uint32_t	debugid;
#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__LP64__</span>)
	uint32_t	cpuid;
	uintptr_t	unused;
#<span class="enscript-reference">endif</span>
} kd_buf;

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__LP64__</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_TIMESTAMP_MASK</span>		0x00ffffffffffffffULL
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CPU_MASK</span>			0xff00000000000000ULL
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CPU_SHIFT</span>			56
<span class="enscript-type">static</span> inline <span class="enscript-type">void</span>
<span class="enscript-function-name">kdbg_set_cpu</span>(kd_buf *kp, <span class="enscript-type">int</span> cpu)
{
	kp-&gt;timestamp = (kp-&gt;timestamp &amp; KDBG_TIMESTAMP_MASK) |
				(((uint64_t) cpu) &lt;&lt; KDBG_CPU_SHIFT);
}
<span class="enscript-type">static</span> inline <span class="enscript-type">int</span>
<span class="enscript-function-name">kdbg_get_cpu</span>(kd_buf *kp)
{
	<span class="enscript-keyword">return</span> (<span class="enscript-type">int</span>) (((kp)-&gt;timestamp &amp; KDBG_CPU_MASK) &gt;&gt; KDBG_CPU_SHIFT);
}
<span class="enscript-type">static</span> inline <span class="enscript-type">void</span>
<span class="enscript-function-name">kdbg_set_timestamp</span>(kd_buf *kp, uint64_t thetime)
{
	kp-&gt;timestamp = thetime &amp; KDBG_TIMESTAMP_MASK;
}
<span class="enscript-type">static</span> inline uint64_t
<span class="enscript-function-name">kdbg_get_timestamp</span>(kd_buf *kp)
{
	<span class="enscript-keyword">return</span> kp-&gt;timestamp &amp; KDBG_TIMESTAMP_MASK;
}
<span class="enscript-type">static</span> inline <span class="enscript-type">void</span>
<span class="enscript-function-name">kdbg_set_timestamp_and_cpu</span>(kd_buf *kp, uint64_t thetime, <span class="enscript-type">int</span> cpu)
{
	kp-&gt;timestamp = (thetime &amp; KDBG_TIMESTAMP_MASK) |
				(((uint64_t) cpu) &lt;&lt; KDBG_CPU_SHIFT);
}
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_TIMESTAMP_MASK</span>		0xffffffffffffffffULL
<span class="enscript-type">static</span> inline <span class="enscript-type">void</span>
<span class="enscript-function-name">kdbg_set_cpu</span>(kd_buf *kp, <span class="enscript-type">int</span> cpu)
{
	kp-&gt;cpuid = cpu;
}
<span class="enscript-type">static</span> inline <span class="enscript-type">int</span>
<span class="enscript-function-name">kdbg_get_cpu</span>(kd_buf *kp)
{
	<span class="enscript-keyword">return</span> kp-&gt;cpuid;
}
<span class="enscript-type">static</span> inline <span class="enscript-type">void</span>
<span class="enscript-function-name">kdbg_set_timestamp</span>(kd_buf *kp, uint64_t thetime)
{
	kp-&gt;timestamp = thetime;
}
<span class="enscript-type">static</span> inline uint64_t
<span class="enscript-function-name">kdbg_get_timestamp</span>(kd_buf *kp)
{
	<span class="enscript-keyword">return</span> kp-&gt;timestamp;
}
<span class="enscript-type">static</span> inline <span class="enscript-type">void</span>
<span class="enscript-function-name">kdbg_set_timestamp_and_cpu</span>(kd_buf *kp, uint64_t thetime, <span class="enscript-type">int</span> cpu)
{
	kdbg_set_timestamp(kp, thetime);
	kdbg_set_cpu(kp, cpu);
}
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* 2^16 bits (8 kilobytes), one for each possible class/subclass combination */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_TYPEFILTER_BITMAP_SIZE</span>	        ( (256 * 256) / 8 )

<span class="enscript-comment">/* Debug Flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_INIT</span>	0x001
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_NOWRAP</span>	0x002
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_FREERUN</span>	0x004
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_WRAPPED</span>	0x008
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_USERFLAGS</span>	(KDBG_FREERUN|KDBG_NOWRAP|KDBG_INIT)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_PIDCHECK</span>   0x010
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_MAPINIT</span>    0x020
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_PIDEXCLUDE</span> 0x040
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_LOCKINIT</span>	0x080
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_LP64</span>	0x100

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	type;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	value1;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	value2;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	value3;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	value4;

} kd_regtype;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span>
{
	<span class="enscript-type">int</span>		nkdbufs;
	<span class="enscript-type">int</span>		nolog;
	<span class="enscript-type">int</span>		flags;
	<span class="enscript-type">int</span>		nkdthreads;
	<span class="enscript-type">int</span>		bufid;
} kbufinfo_t;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	uintptr_t	thread;
	<span class="enscript-type">int</span>		valid;
	<span class="enscript-type">char</span>		command[20];
} kd_threadmap;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	uint32_t	version_no;
	uint32_t	cpu_count;
} kd_cpumap_header;

<span class="enscript-comment">/* cpumap flags */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CPUMAP_IS_IOP</span>	0x1

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	uint32_t	cpu_id;
	uint32_t	flags;
	<span class="enscript-type">char</span>		name[8];
} kd_cpumap;

<span class="enscript-comment">/*
 * TRACE file formats...
 *
 * RAW_VERSION0
 *
 * uint32_t #threadmaps
 * kd_threadmap[]
 * kd_buf[]
 *
 * RAW_VERSION1
 *
 * RAW_header, with version_no set to RAW_VERSION1
 * kd_threadmap[]
 * Empty space to pad alignment to the nearest page boundary.
 * kd_buf[]
 *
 * RAW_VERSION1+
 *
 * RAW_header, with version_no set to RAW_VERSION1
 * kd_threadmap[]
 * kd_cpumap_header, with version_no set to RAW_VERSION1
 * kd_cpumap[]
 * Empty space to pad alignment to the nearest page boundary.
 * kd_buf[]
 *
 * V1+ implementation details...
 *
 * It would have been nice to add the cpumap data &quot;correctly&quot;, but there were
 * several obstacles. Existing code attempts to parse both V1 and V0 files.
 * Due to the fact that V0 has no versioning or header, the test looks like
 * this:
 *
 * // Read header
 * if (header.version_no != RAW_VERSION1) { // Assume V0 }
 *
 * If we add a VERSION2 file format, all existing code is going to treat that
 * as a VERSION0 file when reading it, and crash terribly when trying to read
 * RAW_VERSION2 threadmap entries.
 *
 * To differentiate between a V1 and V1+ file, read as V1 until you reach
 * the padding bytes. Then:
 *
 * boolean_t is_v1plus = FALSE;
 * if (padding_bytes &gt;= sizeof(kd_cpumap_header)) {
 *     kd_cpumap_header header = // read header;
 *     if (header.version_no == RAW_VERSION1) {
 *         is_v1plus = TRUE;
 *     }
 * }
 *
 */</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	<span class="enscript-type">int</span>             version_no;
	<span class="enscript-type">int</span>             thread_count;
	uint64_t        TOD_secs;
	uint32_t        TOD_usecs;
} RAW_header;

<span class="enscript-comment">// Version 3 header
</span><span class="enscript-comment">// The header chunk has the tag 0x00001000 which also serves as a magic word
</span><span class="enscript-comment">// that identifies the file as a version 3 trace file. The header payload is
</span><span class="enscript-comment">// a set of fixed fields followed by a variable number of sub-chunks:
</span><span class="enscript-comment">/*
 ____________________________________________________________________________
 | Offset | Size | Field                                                    |
 ----------------------------------------------------------------------------
 |    0   |  4   | Tag (0x00001000)                                         |
 |    4   |  4   | Sub-tag. Represents the version of the header.           |
 |    8   |  8   | Length of header payload (40+8x)                         |
 |   16   |  8   | Time base info. Two 32-bit numbers, numer/denom,         |
 |        |      | for converting timestamps to nanoseconds.                |
 |   24   |  8   | Timestamp of trace start.                                |
 |   32   |  8   | Wall time seconds since Unix epoch.                      |
 |        |      | As returned by gettimeofday().                           |
 |   40   |  4   | Wall time microseconds. As returned by gettimeofday().   |
 |   44   |  4   | Local time zone offset in minutes. ( &quot; )                 |
 |   48   |  4   | Type of daylight savings time correction to apply. ( &quot; ) |
 |   52   |  4   | Flags. 1 = 64-bit. Remaining bits should be written      |
 |        |      | as 0 and ignored when reading.                           |
 |   56   |  8x  | Variable number of sub-chunks. None are required.        |
 |        |      | Ignore unknown chunks.                                   |
 ----------------------------------------------------------------------------
*/</span>
<span class="enscript-comment">// NOTE: The header sub-chunks are considered part of the header chunk,
</span><span class="enscript-comment">// so they must be included in the header chunks length field.
</span><span class="enscript-comment">// The CPU map is an optional sub-chunk of the header chunk. It provides
</span><span class="enscript-comment">// information about the CPUs that are referenced from the trace events.
</span><span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	uint32_t	tag;
	uint32_t	sub_tag;
	uint64_t 	length;
	uint32_t 	timebase_numer;
	uint32_t 	timebase_denom;
	uint64_t	timestamp;
	uint64_t 	walltime_secs;
	uint32_t	walltime_usecs;
	uint32_t	timezone_minuteswest;
	uint32_t 	timezone_dst;
	uint32_t 	flags;
} kd_header_v3;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
	uint32_t tag;
	uint32_t sub_tag;
	uint64_t length;
} kd_chunk_header_v3;

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RAW_VERSION0</span>	0x55aa0000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RAW_VERSION1</span>	0x55aa0101
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RAW_VERSION2</span>    0x55aa0200 <span class="enscript-comment">/* Only used by kperf and Instruments */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RAW_VERSION3</span>	0x00001000

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_CONFIG</span>	0x00001b00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_CPU_MAP</span>	0x00001c00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_THREAD_MAP</span>	0x00001d00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_RAW_EVENTS</span>	0x00001e00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_NULL_CHUNK</span>	0x00002000

<span class="enscript-comment">// The current version of all kernel managed chunks is 1. The
</span><span class="enscript-comment">// V3_CURRENT_CHUNK_VERSION is added to ease the simple case
</span><span class="enscript-comment">// when most/all the kernel managed chunks have the same version.
</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_CURRENT_CHUNK_VERSION</span> 1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_HEADER_VERSION</span>     V3_CURRENT_CHUNK_VERSION
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_CPUMAP_VERSION</span>     V3_CURRENT_CHUNK_VERSION
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_THRMAP_VERSION</span>     V3_CURRENT_CHUNK_VERSION
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">V3_EVENT_DATA_VERSION</span> V3_CURRENT_CHUNK_VERSION

<span class="enscript-comment">// Apis to support writing v3 chunks in the kernel
</span><span class="enscript-type">int</span> <span class="enscript-function-name">kdbg_write_v3_chunk_header_to_buffer</span>(<span class="enscript-type">void</span> *buffer, uint32_t tag, uint32_t sub_tag, uint64_t length);
<span class="enscript-type">int</span> <span class="enscript-function-name">kdbg_write_v3_chunk_to_fd</span>(uint32_t tag, uint32_t sub_tag, uint64_t length, <span class="enscript-type">void</span> *payload, uint64_t payload_size, <span class="enscript-type">int</span> fd);

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_CLASSTYPE</span>		0x10000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_SUBCLSTYPE</span>		0x20000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_RANGETYPE</span>		0x40000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_TYPENONE</span>		0x80000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_CKTYPES</span>		0xF0000

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_RANGECHECK</span>	0x100000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_VALCHECK</span>	0x200000        <span class="enscript-comment">/* Check up to 4 individual values */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_TYPEFILTER_CHECK</span>	((uint32_t) 0x400000)        <span class="enscript-comment">/* Check class and subclass against a bitmap */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KDBG_BUFINIT</span>	0x80000000

<span class="enscript-comment">/* Minimum value allowed when setting decrementer ticks */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDBG_MINRTCDEC</span>  2500

<span class="enscript-comment">/* VFS lookup events for serial traces */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VFS_LOOKUP</span>	(FSDBG_CODE(DBG_FSRW,36))
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VFS_LOOKUP_DONE</span>	(FSDBG_CODE(DBG_FSRW,39))

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
#<span class="enscript-reference">if</span> (<span class="enscript-variable-name">DEVELOPMENT</span> || <span class="enscript-variable-name">DEBUG</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KDEBUG_MOJO_TRACE</span> 1
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_API_PRIVATE */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !BSD_SYS_KDEBUG_H */</span>
</pre>
<hr />
</body></html>